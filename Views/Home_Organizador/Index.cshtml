<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emissor de Certificados</title>
    <link rel="stylesheet" href="/css/Home_Organizador.css">
    <script src="~/js/Home_Organizador.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
    <img id="logo" src="/logoemescam.png">
</head>
<body>
    <div class="cartao-menu">
        <div style="font-size:larger">Bem-Vindo! "ORGANIZADOR"</div>
        <form>
            <div>
                <a class="nav-link text-dark" href="#" onclick="mostrarCard('meus-eventos')">Meus Eventos</a>
                <a class="nav-link text-dark" href="#" onclick="mostrarCard('buscar-pessoas')">Buscar Pessoas</a>
                <a id="sair-link" class="nav-link text-dark" asp-action="Login" asp-controller="Organizador">Sair</a>
            </div>
        </form>

        <!--CADASTRAR EVENTO-->
        <div id="card-evento" class="card">
            <h3>Novo Evento</h3>
            <hr>
            <!-- Input para o nome do evento -->
            <input type="text" id="nomeEvento" placeholder="Nome do Evento">
            <hr>
            <!--Aqui preenchem os dados-->
            <div class="dados-form">
                <div id="divDados">
                    <input type="text" id="inputNome" placeholder="Nome">
                    <input type="text" id="inputCPF" placeholder="CPF">
                    <input type="text" id="inputEmail1" placeholder="Email">
                    <input type="text" id="tipoPessoa" placeholder="Tipo Pessoa">
                </div>
                <textarea id="textareaTexto" placeholder="Texto"></textarea>
            </div>
            <button id="botaoAcao" onclick="atualizarDados()">Adicionar Dados</button>
            <hr>

            <!--Tabela que será preenchida-->
            <div class="tabela-container">
                <table id="tabela" class="display">
                    <thead>
                        <tr>
                            <th style="width: 20%">Nome</th>
                            <th style="width: 10%">CPF</th>
                            <th style="width: 15%">Email</th>
                            <th style="width: 10%">Tipo Pessoa</th>
                            <th style="width: 40%">Texto</th>
                            <th style="width: 5%">Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Os dados serão inseridos dinamicamente aqui -->
                    </tbody>
                </table>
            </div>

            <div class="upload-container">
                <!-- Botão de importar EXCEL -->
                <input type="file" id="excelFile" accept=".xlsx" style="display:none" onchange="importarExcel()">
                <label for="excelFile" class="custom-file-upload">
                    Importar Pessoas
                </label>
                <span id="fileName" style="margin-left: 10px;"></span>

                <!-- Botão de importar Certificado -->
                <input type="file" id="arteCertificadoFile" accept=".jpeg, .jpg" style="display:none" onchange="importarCertificado()">
                <label for="arteCertificadoFile" class="custom-file-upload">
                    Importar Certificado
                </label>
                <span id="certificadoFileName" style="margin-left: 10px;"></span>
            </div>

            <button id="CadastrarEvento" onclick="cadastrarEvento()">Cadastrar Evento</button>
        </div>

        <div id="card-meus-eventos" class="card">
            <h4>Meus Eventos</h4>
            <!-- Botão de "Adicionar Evento" -->
            <button class="botao-adicionar" onclick="exibirFormularioAdicionar()"></button>
            <!-- Campo de pesquisa -->
            <input type="text" id="campo-pesquisa" placeholder="Pesquisar eventos..." onkeyup="filtrarEventos()">
            <hr>
            <div class="tabela-eventos">
              
                
                <!-- Tabela de eventos -->
                <table>
                    <thead>
                        <tr>
                            <th style="width: 20%">Nome do evento</th>
                            <th>Pessoas</th>
                            <th style="width: 15%;">Imagem do Certificado</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var evento in Model)
                        {
                        <tr>
                            <td>evento</td>
                            <td id="testar">pessoas</td>
                            <td>@evento.Id</td>
                            <td>@evento.Nome</td>
                            <td>
                                <!-- miniatura da imagem -->
                                    <img src="@Url.Action("VisualizarImagem", "Home_Organizador", new { Id=evento.Id })"
                                         alt="imagem do certificado"
                                         style="width: 60px; height: auto; cursor: pointer;"
                                         onclick="window.open('@Url.Action("VisualizarImagem", "Home_Organizador", new { Id=evento.Id })')">

                            </td>
                        </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>

        <div id="card-buscar-pessoas" class="card">
            <div>
                <input type="text" id="searchInput" placeholder="Digite o nome da pessoa">
                <button onclick="buscarPessoas()">Buscar</button>
                <div id="resultList"></div>
                <div class="details" id="details"></div>
            </div>

        </div>


    </div>

    <script>
        window.onload = function () {
            mostrarCard('meus-eventos');
            preencherTabelaEventos();
        };

        function mostrarCard(id) {
            var cards = document.querySelectorAll('.card');
            cards.forEach(function (card) {
                card.style.display = 'none';
            });

            var cardToShow = document.getElementById('card-' + id);
            if (cardToShow) {
                cardToShow.style.display = 'block';
            }
        }

        function exibirFormularioAdicionar() {
            var cards = document.querySelectorAll('.card');
            cards.forEach(function (card) {
                card.style.display = 'none';
            });

            var cardNovoEvento = document.getElementById('card-evento');
            if (cardNovoEvento) {
                cardNovoEvento.style.display = 'block';
                cardNovoEvento.scrollIntoView({ behavior: 'smooth' });
            }
        }

        var eventos = [
            { id: 20376, nome: "CAAL 2020 - CAAL Convida: SUS, História e Desafios", data: "09/11/2020", imagem: "path/to/image1.png" },
            { id: 20373, nome: "CAAL 2020 - CAAL Convida: Crises Sanitárias e Negacionismo", data: "09/11/2020", imagem: "path/to/image2.png" },
            { id: 20372, nome: "CAAL 2020 - CAAL Convida: Efeito Werther e Suicídio", data: "09/11/2020", imagem: "path/to/image3.png" }
        ];

        function preencherTabelaEventos() {
            var tabelaEventos = document.getElementById('eventos-tbody');
            tabelaEventos.innerHTML = '';

            eventos.forEach(function (evento) {
                var novaLinha = tabelaEventos.insertRow();

                var celulaCodigo = novaLinha.insertCell(0);
                celulaCodigo.textContent = evento.id;

                var celulaNome = novaLinha.insertCell(1);
                celulaNome.textContent = evento.nome;

                var celulaImagem = novaLinha.insertCell(2);
                var img = document.createElement('img');
                img.src = evento.imagem;
                img.style.width = '60px';
                img.style.cursor = 'pointer';
                img.onclick = function () {
                    window.open(evento.imagem);
                };
                celulaImagem.appendChild(img);

                var celulaAcoes = novaLinha.insertCell(3);
                var botaoEmitir = document.createElement('button');
                botaoEmitir.textContent = 'Emitir certificado';
                botaoEmitir.className = 'btn btn-emitir';
                botaoEmitir.onclick = function () {
                    emitirCertificado(evento.nome);
                };
                celulaAcoes.appendChild(botaoEmitir);

                var botaoAtualizar = document.createElement('button');
                botaoAtualizar.textContent = 'Atualizar';
                botaoAtualizar.className = 'btn btn-atualizar';
                botaoAtualizar.onclick = function () {
                    atualizarEvento(evento.nome);
                };
                celulaAcoes.appendChild(botaoAtualizar);
            });

            destacarCPFsInvalidos();
        }

        function emitirCertificado(nome) {
            alert('Emitir certificado para: ' + nome);
        }

        function atualizarEvento(nome) {
            alert('Atualizar evento: ' + nome);
        }

        var modoAdicionar = true;
        var linhaEditavel;

        function adicionarBotoesLinha(linha) {
            var colunaAcoes = linha.insertCell(-1);
            var botaoExcluir = document.createElement("button");
            botaoExcluir.textContent = "Excluir";
            botaoExcluir.className = 'btn table-btn';
            botaoExcluir.onclick = function () {
                excluirLinha(linha);
                destacarCPFsInvalidos();
            };
            colunaAcoes.appendChild(botaoExcluir);

            var botaoAtualizar = document.createElement("button");
            botaoAtualizar.textContent = "Atualizar";
            botaoAtualizar.className = 'btn table-btn';
            botaoAtualizar.onclick = function () {
                carregarDadosParaEditar(linha);
            };
            colunaAcoes.appendChild(botaoAtualizar);
        }

        function atualizarDados() {
            if (modoAdicionar) {
                var tabela = document.getElementById("tabela");
                var nome = document.getElementById("inputNome").value;
                var cpf = document.getElementById("inputCPF").value;
                var email = document.getElementById("inputEmail1").value;
                var tipoPessoa = document.getElementById("tipoPessoa").value;
                var texto = document.getElementById("textareaTexto").value;

                if (nome === "" || cpf === "" || email === "" || tipoPessoa === "" || texto === "") {
                    alert("Por favor, preencha todos os campos.");
                    return;
                }

                var novaLinha = tabela.insertRow(-1);
                var celulaNome = novaLinha.insertCell(0);
                var celulaCPF = novaLinha.insertCell(1);
                var celulaEmail = novaLinha.insertCell(2);
                var celulaTipoPessoa = novaLinha.insertCell(3);
                var celulaTexto = novaLinha.insertCell(4);

                celulaNome.textContent = nome;
                celulaCPF.textContent = cpf;
                celulaEmail.textContent = email;
                celulaTipoPessoa.textContent = tipoPessoa;
                celulaTexto.textContent = texto;

                adicionarBotoesLinha(novaLinha);
                limparCampos();
                destacarCPFsInvalidos();
            } else {
                var celulas = linhaEditavel.getElementsByTagName("td");
                celulas[0].textContent = document.getElementById("inputNome").value;
                celulas[1].textContent = document.getElementById("inputCPF").value;
                celulas[2].textContent = document.getElementById("inputEmail1").value;
                celulas[3].textContent = document.getElementById("tipoPessoa").value;
                celulas[4].textContent = document.getElementById("textareaTexto").value;
                alternarModo();
                limparCampos();
                destacarCPFsInvalidos();
            }
        }

        function excluirLinha(linha) {
            var index = linha.rowIndex;
            document.getElementById("tabela").deleteRow(index);
            destacarCPFsInvalidos();
        }

        function carregarDadosParaEditar(linha) {
            var celulas = linha.getElementsByTagName("td");
            document.getElementById("inputNome").value = celulas[0].textContent;
            document.getElementById("inputCPF").value = celulas[1].textContent;
            document.getElementById("inputEmail1").value = celulas[2].textContent;
            document.getElementById("tipoPessoa").value = celulas[3].textContent;
            document.getElementById("textareaTexto").value = celulas[4].textContent;

            linhaEditavel = linha;
            alternarModo();
        }

        function alternarModo() {
            modoAdicionar = !modoAdicionar;
            var botaoAcao = document.getElementById("botaoAcao");
            botaoAcao.textContent = modoAdicionar ? "Adicionar Dados" : "Atualizar Dados";
        }

        function limparCampos() {
            document.getElementById("inputNome").value = "";
            document.getElementById("inputCPF").value = "";
            document.getElementById("inputEmail1").value = "";
            document.getElementById("tipoPessoa").value = "";
            document.getElementById("textareaTexto").value = "";
        }

        function importarExcel() {
            var input = document.getElementById('excelFile');
            if (!input.files || input.files.length === 0) {
                alert('Por favor, selecione um arquivo Excel.');
                return;
            }

            var file = input.files[0];
            var reader = new FileReader();

            reader.onload = function (e) {
                var data = new Uint8Array(e.target.result);
                var workbook = XLSX.read(data, { type: 'array' });
                var sheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[sheetName];

                var expectedColumns = ['NOME_PESSOA', 'CPF_PESSOA', 'EMAIL_PESSOA', 'TIPO_PESSOA', 'TEXTO'];
                var headerRow = XLSX.utils.sheet_to_json(worksheet, { header: 1, range: 'A1:E1' })[0];
                var isValidModel = expectedColumns.every(function (col, index) {
                    return headerRow[index] === col;
                });

                if (!isValidModel) {
                    alert('O modelo da planilha selecionada está incorreto.');
                    return;
                }

                var table = document.getElementById('tabela').getElementsByTagName('tbody')[0];
                table.innerHTML = ''; // Limpa a tabela antes de adicionar novas linhas

                var rows = XLSX.utils.sheet_to_json(worksheet, { header: 1, range: 1 });
                rows.forEach(function (row, rowIndex) {
                    var newRow = table.insertRow(-1);
                    row.forEach(function (cellContent) {
                        var cell = newRow.insertCell();
                        cell.textContent = cellContent;
                    });
                    // Adiciona botões de ação a cada linha, exceto se for a última linha do arquivo
                    if (rowIndex < rows.length - 1) {
                        adicionarBotoesLinha(newRow);
                    }
                });
                destacarDuplicatas(); // Destaca duplicatas após carregar os dados
            };
            reader.readAsArrayBuffer(file);
        }

        function cadastrarEvento() {
            var nomeEvento = document.getElementById('nomeEvento').value;
            if (nomeEvento.trim() === '') {
                alert('Por favor, insira o nome do evento.');
                return;
            }

            var tabelaEventos = document.getElementById('eventos-tbody');
            var novaLinha = tabelaEventos.insertRow(-1);

            var celulaCodigo = novaLinha.insertCell(0);
            celulaCodigo.textContent = eventos.length + 1; 

            var celulaNome = novaLinha.insertCell(1);
            celulaNome.textContent = nomeEvento;

            var celulaImagem = novaLinha.insertCell(2);
            var imgCertificado = document.createElement('img');
            var certificadoFile = document.getElementById('arteCertificadoFile').files[0];
            if (certificadoFile) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    imgCertificado.src = e.target.result;
                    imgCertificado.style.width = '60px';
                    celulaImagem.appendChild(imgCertificado);
                };
                reader.readAsDataURL(certificadoFile);
            } else {
                imgCertificado.src = '';
                celulaImagem.appendChild(imgCertificado);
            }

            var celulaAcoes = novaLinha.insertCell(3);

            var botaoEmitir = document.createElement('button');
            botaoEmitir.textContent = 'Emitir certificado';
            botaoEmitir.className = 'btn btn-emitir'; // Classe para estilizar
            botaoEmitir.onclick = function () {
                emitirCertificado(nomeEvento);
            };
            celulaAcoes.appendChild(botaoEmitir);

            var botaoAtualizar = document.createElement('button');
            botaoAtualizar.textContent = 'Atualizar';
            botaoAtualizar.className = 'btn btn-atualizar'; // Classe para estilizar
            botaoAtualizar.onclick = function () {
                atualizarEvento(nomeEvento);
            };
            celulaAcoes.appendChild(botaoAtualizar);

            // Adiciona o novo evento à lista de eventos
            eventos.push({ id: eventos.length + 1, nome: nomeEvento, data: new Date().toLocaleDateString(), imagem: imgCertificado.src });

            // Envia os dados do evento para o backend
            enviarDadosEvento();
        }

        function enviarDadosEvento() {
            var nomeEvento = document.getElementById('nomeEvento').value;
            var arquivoCertificado = document.getElementById('arteCertificadoFile').files[0];
            var tabela = document.getElementById('tabela');
            var dadosTabela = [];
            var linhas = tabela.getElementsByTagName('tr');

            for (var i = 1; i < linhas.length; i++) {
                var linha = linhas[i];
                var celulas = linha.getElementsByTagName('td');
                var dadosLinha = [];

                for (var j = 0; j < celulas.length - 1; j++) {
                    dadosLinha.push(celulas[j].textContent);
                }

                dadosTabela.push(dadosLinha);
            }

            var formData = new FormData();
            formData.append('Nome', nomeEvento);
            formData.append('ImagemCertificado', arquivoCertificado);

            // Transformar dadosTabela em JSON e adicionar ao FormData como um campo string
            formData.append('DadosTabela', JSON.stringify(dadosTabela));

            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/Home_Organizador/NovoEvento');
            xhr.setRequestHeader('RequestVerificationToken', document.querySelector('input[name="__RequestVerificationToken"]').value);
            xhr.onload = function () {
                if (xhr.status === 200) {
                    alert('Evento cadastrado com sucesso!');
                    window.location.href = '/Home_Organizador/Index';
                } else {
                    alert('Erro ao cadastrar o evento. Por favor, tente novamente.');
                }
            };
            xhr.send(formData);
        }

        // // Função para enviar os dados do evento para o controller
        // function enviarDadosEvento() {
        //     // Obter o nome do evento
        //     var nomeEvento = document.getElementById('nomeEvento').value;

        //     // Obter a imagem do certificado
        //     var arquivoCertificado = document.getElementById('arteCertificadoFile').files[0];

        //     // Construir o objeto FormData para enviar os dados
        //     var formData = new FormData();
        //     formData.append('Nome', nomeEvento);
        //     formData.append('ImagemCertificado', arquivoCertificado);

        //     // Adicionar o token antifalsificação à solicitação
        //     formData.append('__RequestVerificationToken', token);

        //     // Enviar os dados para o controller usando AJAX
        //     var xhr = new XMLHttpRequest();
        //     xhr.open('POST', '/Home_Organizador/NovoEvento');
        //     xhr.onload = function () {
        //         // Tratar a resposta do servidor, se necessário
        //         if (xhr.status === 200) {
        //             alert('Evento cadastrado com sucesso!');
        //             // Redirecionar para a página inicial, por exemplo
        //             window.location.href = '/Home_Organizador/Index';
        //         } else {
        //             alert('Erro ao cadastrar o evento. Por favor, tente novamente.');
        //         }
        //     };
        //     xhr.send(formData);
        // }

        function filtrarEventos() {
            var input = document.getElementById('campo-pesquisa');
            var filter = input.value.toUpperCase();
            var tbody = document.getElementById("eventos-tbody");
            var tr = tbody.getElementsByTagName("tr");

            for (var i = 0; i < tr.length; i++) {
                var td = tr[i].getElementsByTagName("td")[1]; // Index 1 é a coluna do Nome do Evento
                if (td) {
                    var txtValue = td.textContent || td.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                }
            }
        }

        function destacarDuplicatas() {
            const tabela = document.getElementById("tabela").getElementsByTagName("tbody")[0];
            const linhas = tabela.getElementsByTagName("tr");
            let valoresVistos = {
                nome: {},
                cpf: {},
                email: {},
                texto: {}
            };

            Array.from(linhas).forEach((linha, linhaIndex) => {
                ["nome", "cpf", "email", "texto"].forEach((campo, index) => {
                    const valor = linha.cells[index].textContent.trim();
                    console.log(`Processando: ${campo}, Valor: ${valor}, Linha: ${linhaIndex}`); // Debugar valor e linha
                    if (valoresVistos[campo][valor]) {
                        valoresVistos[campo][valor].push(linha.cells[index]);
                    } else {
                        valoresVistos[campo][valor] = [linha.cells[index]];
                    }
                });
            });

            Object.keys(valoresVistos).forEach(campo => {
                console.log(`Duplicatas em ${campo}:`, valoresVistos[campo]); // Mostrar estrutura de duplicatas
                Object.keys(valoresVistos[campo]).forEach(valor => {
                    if (valoresVistos[campo][valor].length > 1) {
                        valoresVistos[campo][valor].forEach(celula => {
                            celula.classList.add('duplicado');
                        });
                    }
                });
            });
        }

        function destacarCPFsInvalidos() {
            var tabela = document.getElementById("tabela");
            var linhas = tabela.getElementsByTagName("tr");
            for (var i = 0; i < linhas.length; i++) {
                var celulaCPF = linhas[i].getElementsByTagName("td")[1]; // Assume que CPF está na segunda coluna
                if (celulaCPF && !validarCPF(celulaCPF.textContent)) {
                    celulaCPF.style.backgroundColor = 'red'; // Pinta de vermelho se o CPF for inválido
                }
            }
        }

        function validarCPF(cpf) {
            cpf = cpf.replace(/[^\d]+/g, '');
            if (cpf.length != 11) {
                return false;
            }

            var numeros = cpf.substring(0, 9);
            var digitos = cpf.substring(9);
            var soma = 0;
            var resultado;

            for (var i = 10; i > 1; i--) {
                soma += numeros.charAt(10 - i) * i;
            }

            resultado = (soma % 11) < 2 ? 0 : 11 - (soma % 11);
            if (resultado != parseInt(digitos.charAt(0))) {
                return false;
            }

            soma = 0;
            numeros = cpf.substring(0, 10);
            for (i = 11; i > 1; i--) {
                soma += numeros.charAt(11 - i) * i;
            }

            resultado = (soma % 11) < 2 ? 0 : 11 - (soma % 11);
            return resultado == parseInt(digitos.charAt(1));
        }

        function buscarPessoas() {
            var termo = $("#searchInput").val();
            if (termo.length >= 3) { // Buscar apenas se o nome tiver 3 ou mais caracteres
                $.ajax({
                    url: '/Pessoa/BuscarPessoas',
                    type: 'GET',
                    data: { termo: termo },
                    success: function (data) {
                        var resultList = $("#resultList");
                        resultList.empty(); // Limpar resultados anteriores

                        data.forEach(function (pessoa) {
                            var item = $("<div class='result-item'></div>")
                                .text(pessoa.nome)  // Certifique-se de que "pessoa.nome" está correto
                                .data("id", pessoa.id)  // Certifique-se de que "pessoa.id" está correto
                                .data("cpf", pessoa.cpf)
                                .data("email", pessoa.email)
                                .on("click", function () {
                                    exibirDetalhes($(this).data("id"), $(this).text(), $(this).data("cpf"), $(this).data("email"));
                                });
                            resultList.append(item);
                        });
                    },
                    error: function () {
                        alert("Erro ao buscar pessoas.");
                    }
                });
            }
        }

        function exibirDetalhes(id, nome, cpf, email) {
            var details = $("#details");
            details.empty(); // Limpar detalhes anteriores

            details.append("<p>ID: " + id + "</p>");
            details.append("<p>Nome: " + nome + "</p>");
            details.append("<p>CPF: " + cpf + "</p>");
            details.append("<p>Email: " + email + "</p>");
        }

    </script>

</body>
</html>

<style>
    #logoEmescam {
    }

    #logo {
        width: 20%;
        position: fixed;
        top: 0%;
        left: 11%;
        transform: translateX(-50%);
        margin-top: 0;
        text-align: center;
    }

    body {
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: #14086d;
        font-family: Arial, sans-serif;
    }

    .cartao-menu {
        background-color: rgba(250, 235, 215, 0.5);
        border-radius: 5px;
        box-shadow: 0px 0px 20px 0px rgba(0,0,0,0.2);
        padding: 5%;
        width: 18%;
        max-width: 50%;
        height: 80%;
        text-align: center;
        position: fixed;
        top: 55%;
        left: 10%;
        transform: translate(-50%, -50%);
        background-color: white;
    }

        .cartao-menu a {
            display: block;
            text-decoration: none;
            color: #000;
            margin: 10px 0;
            padding: 10px;
            border: 1px solid transparent;
            transition: color 0.3s, border-color 0.3s;
            border-color: #14086D;
        }

            .cartao-menu a:hover {
                color: #ff0000;
                border-color: #ff0000;
            }

    .card {
        background-color: rgba(250, 235, 215, 0.5);
        padding: 5%;
        width: 442%;
        height: 100%;
        text-align: center;
        position: fixed;
        top: 0;
        left: 103%;
        border-radius: 5px;
        display: none; /* Oculta o card por padrão */
        background-color: white;
    }

    #card-evento {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        background-color: white;
    }

    #nomeEvento {
        width: 96%;
        margin-bottom: 2px;
        margin-left: 3.7%
    }

    .dados-form {
        display: flex;
        flex-direction: row;
        align-items: flex-start;
        justify-content: space-between;
        width: 100%;
    }

        .dados-form input, .dados-form textarea {
            margin-bottom: 10px;
        }

        .dados-form input {
            width: calc(70% - 10px);
        }

    #textareaTexto {
        width: 100%;
        height: 150px;
        padding: 10px;
        margin-left: -40px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;
    }

    #tabela {
        width: 100%;
        border-collapse: collapse;
        max-height: 300px;
    }

        #tabela th {
            background-color: #f2f2f2;
        }

        #tabela tbody tr {
            border-bottom: 1px solid black;
        }

            #tabela tbody tr:nth-child(even) {
                background-color: #f9f9f9;
            }

            #tabela tbody tr:nth-child(odd) {
                background-color: white;
            }

    .tabela-container {
        max-height: 320px;
        overflow-y: auto;
    }

    button.btn {
        padding: 10px 20px;
        font-size: 16px;
        text-transform: uppercase;
        color: white;
        border: none;
        border-radius: 2px;
        cursor: pointer;
        margin: 5px;
        transition: background-color 0.3s;
    }

    button.btn-emitir {
        background-color: #4CAF50; /* Verde */
    }

        button.btn-emitir:hover {
            background-color: #45a049;
        }

    button.btn-atualizar {
        background-color: #008CBA; /* Azul */
    }

        button.btn-atualizar:hover {
            background-color: #007B9E;
        }

    #CadastrarEvento {
        background-color: #4CAF50; /* Verde */
        color: white;
        padding: 5px 10px;
        text-align: center;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
        border-radius: 2px;
    }

        #CadastrarEvento:hover {
            background-color: #008CBA; /* Azul */
        }

    .upload-container {
        position: relative;
        width: 100%;
        height: 60px; /* Ajuste a altura conforme necessário */
        background-color: transparent;
    }

    .custom-file-upload {
        display: inline-block;
        padding: 3px 6px;
        cursor: pointer;
        background-color: #007bff; /* Cor azul */
        color: white;
        border: none;
        border-radius: 2px; /* Bordas arredondadas */
        position: relative; /* Posicionamento alterado para relativo */
        margin: 10px 5px 10px 5px; /* Margens adicionadas para espaçamento */
    }

    #excelFile + .custom-file-upload {
        float: left; /* Posiciona o botão de Excel à esquerda */
        margin-right: 300px; /* Aumenta a margem à direita */
    }

    #arteCertificadoFile + .custom-file-upload {
        float: right; /* Posiciona o botão de Certificado à direita */
        margin-left: 300px; /* Aumenta a margem à esquerda */
    }

    span {
        position: relative; /* Ajuste de posicionamento */
        display: inline-block; /* Tornando inline para alinhamento */
        vertical-align: middle; /* Alinhamento vertical */
        margin-left: 10px; /* Espaçamento após o botão */
        background-color: #fff; /* Mantendo o fundo branco */
        border-radius: 5px; /* Bordas levemente arredondadas */
        padding: 2px 5px;
    }

    hr {
        margin-top: 1px;
        margin-bottom: 3px;
    }

    .btn.table-btn {
        background-color: #007bff; /* Fundo azul para o botão */
        color: white; /* Texto rosa */
        border: none; /* Sem borda */
        padding: 2px; /* Espaçamento interno mínimo */
        font-size: 10px; /* Tamanho de fonte reduzido */
        text-align: center; /* Centraliza o texto dentro do botão */
        border-radius: 3px; /* Bordas levemente arredondadas */
        cursor: pointer; /* Cursor do mouse como ponteiro para indicar ação */
        margin: 1px; /* Margem mínima entre botões */
        transition: background-color 0.3s, color 0.3s; /* Transição suave para hover */
        width: 70px; /* Largura fixa para todos os botões */
    }

        .btn.table-btn:hover {
            background-color: #007bff; /* Cor de fundo ao passar o mouse */
            color: white; /* Cor do texto ao passar o mouse */
        }

    #botaoAcao {
        background-color: #007bff; /* Cor de fundo do botão */
        color: white; /* Cor da fonte */
        border: none; /* Sem borda */
        padding: 3px 6px; /* Espaçamento interno para aumentar a área de clique */
        font-size: 13px; /* Tamanho da fonte */
        cursor: pointer; /* Cursor em forma de ponteiro quando passar o mouse sobre o botão */
        border-radius: 2px; /* Bordas retangulares sem arredondamento */
    }

    .duplicado {
        background-color: yellow !important; /* Adiciona !important para garantir aplicação */
    }

    #resultadosBusca div {
        cursor: pointer;
        padding: 5px;
        margin-top: 2px;
        background-color: #f0f0f0;
        border: 1px solid #ddd;
    }

        #resultadosBusca div:hover {
            background-color: #e9e9e9;
        }

    #detalhesPessoa p {
        font-size: 14px;
        color: #333;
    }

</style>
