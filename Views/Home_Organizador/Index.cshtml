<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emissor de Certificados</title>
    <div id="logoEmescam"><img src="/LogoEmescam.png" alt="logo"></div>
</head>
<body>
    <div class="cartao-menu">
        <div id="welcome-message" style="font-size:larger">Bem-Vindo! @ViewBag.Login</div>
        <form>
            <div>
                <a class="nav-link text-dark" href="#" onclick="mostrarCard('meus-eventos')">Meus Eventos</a>
                <a class="nav-link text-dark" href="#" onclick="mostrarCard('buscar-pessoas')">Buscar Pessoas</a>
                <a id="sair-link" class="nav-link text-dark" asp-action="Login" asp-controller="Organizador">Sair</a>
            </div>
        </form>


        <!--CADASTRAR EVENTO-->
        <div id="card-evento" class="card">
            <h3>Novo Evento</h3>
            <hr>
            <!-- Input para o nome do evento -->
            <input type="text" id="nomeEvento" placeholder="Nome do Evento">

            <!--Aqui preenchem os dados-->
            <div id="dados-form">
                <input type="text" id="inputNome" placeholder="Nome">
                <input type="text" id="inputCPF" placeholder="CPF">
                <input type="text" id="inputEmail1" placeholder="Email">
                <input type="text" id="tipoPessoa" placeholder="Tipo Pessoa">
                <textarea id="textareaTexto" placeholder="Texto"></textarea>
                <!-- <button id="botaoAdicionar" onclick="atualizarDados()">Adicionar Dados</button> -->
                <button id="botaoAcao" onclick="atualizarDados()">Adicionar Dados</button>
            </div>
            <hr>
            <div class="upload-container">
                <!-- Botão de importar EXCEL -->
                <input type="file" id="excelFile" accept=".xlsx">
                <button onclick="importarExcel()">Importar Pessoas</button>
                <input type="file" id="arteCertificadoFile" accept=".jpeg">
                <button onclick="importarArteCertificado()">Importar Certificado</button>
            </div>
            <!--Tabela que será preenchida-->
            <table id="tabela" class="display">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>CPF</th>
                        <th>Email</th>
                        <th>Tipo Pessoa</th>
                        <th>Texto</th>
                        <th>ações</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            <button id="CadastrarEvento">Cadastrar Evento</button>
        </div>

        @* <div id="card-meus-eventos" class="card">
            <h4>Meus Eventos</h4>
            <!-- Botão de "Adicionar Evento" -->
            <button class="botao-adicionar" onclick="exibirFormularioAdicionar()"></button>

            <!-- Campo de pesquisa -->
            <input type="text" id="campo-pesquisa" placeholder="Pesquisar eventos...">

            <div class="tabela-eventos">
                <!-- Tabela de eventos -->
                <table>
                    <tr>
                        <td class="eventos">Informações do evento 1</td>
                    </tr>
                </table>
            </div>
        </div> *@



        <div id="card-meus-eventos" class="card">
            <h4>Meus Eventos</h4>
            <!-- Botão de "Adicionar Evento" -->
            <button class="botao-adicionar" onclick="exibirFormularioAdicionar()"></button>

            <!-- Campo de pesquisa -->
            <input type="text" id="campo-pesquisa" placeholder="Pesquisar eventos...">

            <div class="tabela-eventos">
                <!-- Tabela de eventos -->
                <table>
                    <thead>
                        <tr>
                            <th style="width: 5%;">Código</th>
                            <th style="width: 80%">Nome</th>
                            <th style="width: 15%;">Imagem do Certificado</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var evento in Model)
                        {
                            <tr>
                                <td>@evento.Id</td>
                                <td>@evento.Nome</td>                                
                                <td>
                                    <!-- Miniatura da imagem -->
                                    <img src="@Url.Action("VisualizarImagem", "Home_Organizador", new { id = evento.Id })"
                                         alt="Imagem do Certificado"
                                         style="width: 60px; height: auto; cursor: pointer;"
                                         onclick="window.open('@Url.Action("VisualizarImagem", "Home_Organizador", new { id = evento.Id })')">
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>






        <div id="card-buscar-pessoas" class="card">
            Informações sobre Buscar Pessoas
        </div>
    </div>
</body>
</html>

<style>
    #logoEmescam {
        position: fixed;
        top: 70px;
        left: 150px;
        transform: translate(-50%, -50%);
        border-radius: 5px;
        width: 300px;
        text-align: center;
    }

        #logoEmescam img {
            width: 350px;
        }

    body {
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: linear-gradient(135deg, #01f949, #14086d);
        font-family: Arial, sans-serif;
    }

    .cartao-menu {
        background-color: rgba(250, 235, 215, 0.5);
        border-radius: 15px;
        box-shadow: 0px 0px 20px 0px rgba(0,0,0,0.2);
        padding: 5%;
        width: 18%;
        max-width: 50%;
        height: 80%;
        text-align: center;
        position: fixed;
        top: 55%;
        left: 10%;
        transform: translate(-50%, -50%);
    }

        .cartao-menu a {
            display: block;
            text-decoration: none;
            color: #000;
            margin: 10px 0;
            padding: 10px;
            border: 1px solid transparent;
            transition: color 0.3s, border-color 0.3s;
            border-color: #14086D;
        }

            .cartao-menu a:hover {
                color: #ff0000;
                border-color: #ff0000;
            }

    .card {
        background-color: rgba(250, 235, 215, 0.5);
        padding: 5%;
        width: 442%;
        height: 100%;
        text-align: center;
        position: fixed;
        top: 0;
        left: 103%;
        border-radius: 15px;
        display: none; /* Oculta o card por padrão */
    }


    .tabela-eventos {
        max-height: 300px;
        overflow-y: auto;
        padding-right: 10px;
    }

    #campo-pesquisa {
        margin-bottom: 10px;
        width: 100%;
        padding: 5px;
        border-radius: 5px;
        border: 1px solid #ccc;
    }

    .eventos {
        background-color: #fff;
        padding: 10px;
        border: 5px solid #ccc;
        border-radius: 5px;
        width: 1300px;
    }

    .eventos1 {
        background-color: #f9f9f9;
    }

    .botao-adicionar {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: deepskyblue;
        border: none;
        color: white;
        font-size: 24px;
        cursor: pointer;
        position: absolute;
        top: 20px;
        right: 10px;
        overflow: hidden;
    }

        .botao-adicionar::after {
            content: "+";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .botao-adicionar:hover {
            background-color: green;
        }

            .botao-adicionar:hover::after {
                color: black;
            }

    #card-evento {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }

    label {
        margin-bottom: 5px;
    }

    textarea {
        margin-bottom: 10px;
    }

    #card-evento {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }

    .textarea-container {
        display: grid;
        justify-items: left;
        text-align: center;
    }

    h7 {
        margin-bottom: 5px;
    }

    textarea {
        margin-top: 5px;
        margin-bottom: 10px;
        width: 650px;
    }

    .input-file {
        display: grid;
        justify-items: left;
        text-align: center;
    }

    #input-avancar {
        background: green;
        color: white;
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
    }

    #dados-form {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 80%;
        padding: 20px;
    }

    #inputCPF {
    }

    #inputEmail1 {
    }

    #tipoPessoa {
    }

    #textareaTexto {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;
    }

    #atualizarDados {
        background-color: green;
        border: none;
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

        #atualizarDados:hover {
            background-color: deepskyblue;
        }

    .upload-container {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1%;
    }

        .upload-container input[type="file"] {
            margin-right: 0.3%;
        }



        .upload-container button {
            background-color: green;
            border: none;
            color: white;
            padding: 3px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

            .upload-container button:hover {
                background-color: deepskyblue;
            }
    /* Estilos para a tabela */
    #tabela {
        width: 100%;
        border-collapse: collapse;
        max-height: 10px; /* Altura máxima da tabela */
        overflow-y: auto; /* Adicionar rolagem vertical quando necessário */
    }

        #tabela th, #tabela td {
            border: 1px solid #dddddd;
            padding: 8px;
            text-align: left;
        }

        #tabela th {
            background-color: #f2f2f2; /* Cor de fundo do cabeçalho */
        }

        /* Estilos para linhas alternadas */
        #tabela tbody tr:nth-child(even) {
            background-color: #f9f9f9; /* Cor de fundo para linhas pares */
        }

    /* Estilo para a rolagem automática */
    .scrollable {
        max-height: 50px; /* Altura máxima antes de aparecer a barra de rolagem */
        overflow-y: auto;
    }

</style>

<script>
    window.onload = function () {
        mostrarCard('meus-eventos');
    };

    function mostrarCard(id) {
        var cards = document.querySelectorAll('.card');
        cards.forEach(function (card) {
            card.style.display = 'none';
        });

        var cardToShow = document.getElementById('card-' + id);
        if (cardToShow) {
            cardToShow.style.display = 'block';
        }
    }

    function exibirFormularioAdicionar() {
        // Oculta todos os cards exceto o card de novo evento
        var cards = document.querySelectorAll('.card');
        cards.forEach(function (card) {
            card.style.display = 'none';
        });

        // Exibe o card de novo evento
        var cardNovoEvento = document.getElementById('card-evento');
        if (cardNovoEvento) {
            cardNovoEvento.style.display = 'block';

            // Rola a página até o card de novo evento
            cardNovoEvento.scrollIntoView({ behavior: 'smooth' });
        }
    }

    // Captura o campo de pesquisa
    var campoPesquisa = document.getElementById('campo-pesquisa');

    // Captura a tabela de eventos
    var tabelaEventos = document.querySelector('.tabela-eventos');
    var linhasEventos = tabelaEventos.getElementsByTagName('tr');

    // Adiciona um ouvinte de evento de entrada ao campo de pesquisa
    campoPesquisa.addEventListener('input', function () {
        var termoPesquisa = campoPesquisa.value.toLowerCase(); // Converte o termo de pesquisa para minúsculas

        // Itera sobre as linhas da tabela de eventos
        for (var i = 1; i < linhasEventos.length; i++) { // Começa do índice 1 para ignorar o cabeçalho da tabela
            var colunasEvento = linhasEventos[i].getElementsByTagName('td'); // Obtém todas as colunas da linha

            var encontrado = false; // Variável para rastrear se o termo de pesquisa foi encontrado em qualquer coluna

            // Itera sobre as colunas do evento
            for (var j = 0; j < colunasEvento.length; j++) {
                var textoColuna = colunasEvento[j].textContent || colunasEvento[j].innerText; // Obtém o texto da coluna
                if (textoColuna.toLowerCase().indexOf(termoPesquisa) > -1) { // Verifica se o termo de pesquisa está presente na coluna
                    encontrado = true;
                    break; // Interrompe a iteração se o termo de pesquisa for encontrado em qualquer coluna
                }
            }

            // Exibe ou oculta a linha com base no resultado da pesquisa
            if (encontrado) {
                linhasEventos[i].style.display = ''; // Exibe a linha se o termo de pesquisa for encontrado em qualquer coluna
            } else {
                linhasEventos[i].style.display = 'none'; // Oculta a linha se o termo de pesquisa não for encontrado em nenhuma coluna
            }
        }
    });

    //Preencher table de novo evento
    // Função para adicionar botões de exclusão e atualização a cada linha da tabela
    function adicionarBotoesLinha(linha) {
        var colunaAcoes = linha.insertCell(-1);
        var botaoExcluir = document.createElement("button");
        botaoExcluir.textContent = "Excluir";
        botaoExcluir.onclick = function () {
            excluirLinha(linha);
        };
        colunaAcoes.appendChild(botaoExcluir);

        var botaoAtualizar = document.createElement("button");
        botaoAtualizar.textContent = "Atualizar";
        botaoAtualizar.onclick = function () {
            carregarDadosParaEditar(linha);
        };
        colunaAcoes.appendChild(botaoAtualizar);
    }

    // Função para adicionar ou atualizar dados
    function atualizarDados() {
        if (modoAdicionar) {
            // Se estiver no modo de adicionar, adiciona uma nova linha
            var tabela = document.getElementById("tabela");

            // Obter os valores dos inputs
            var nome = document.getElementById("inputNome").value;
            var cpf = document.getElementById("inputCPF").value;
            var email = document.getElementById("inputEmail1").value;
            var tipoPessoa = document.getElementById("tipoPessoa").value;
            var texto = document.getElementById("textareaTexto").value;

            // Verificar se todos os campos estão preenchidos
            if (nome === "" || cpf === "" || email === "" || tipoPessoa === "" || texto === "") {
                alert("Por favor, preencha todos os campos.");
                return;
            }

            // Adicionar uma nova linha com os valores inseridos
            var novaLinha = tabela.insertRow(-1); // Insere na última posição da tabela
            var celulaNome = novaLinha.insertCell(0);
            var celulaCPF = novaLinha.insertCell(1);
            var celulaEmail = novaLinha.insertCell(2);
            var celulaTipoPessoa = novaLinha.insertCell(3);
            var celulaTexto = novaLinha.insertCell(4);

            // Atribuir os valores às células da nova linha
            celulaNome.innerHTML = nome;
            celulaCPF.innerHTML = cpf;
            celulaEmail.innerHTML = email;
            celulaTipoPessoa.innerHTML = tipoPessoa;
            celulaTexto.innerHTML = texto;

            // Adicionar botões de exclusão e atualização
            adicionarBotoesLinha(novaLinha);

            // Limpar os inputs após adicionar a tabela
            limparCampos();
        } else {
            // Se estiver no modo de atualizar, atualiza a linha existente
            var celulas = linhaEditavel.getElementsByTagName("td");
            celulas[0].innerHTML = document.getElementById("inputNome").value;
            celulas[1].innerHTML = document.getElementById("inputCPF").value;
            celulas[2].innerHTML = document.getElementById("inputEmail1").value;
            celulas[3].innerHTML = document.getElementById("tipoPessoa").value;
            celulas[4].innerHTML = document.getElementById("textareaTexto").value;

            // Volta para o modo de adicionar
            alternarModo();
        }
    }

    // Função para excluir uma linha da tabela
    function excluirLinha(linha) {
        var index = linha.rowIndex;
        document.getElementById("tabela").deleteRow(index);
    }

    // Função para atualizar uma linha da tabela
    function atualizarLinha(linha) {
        var celulas = linha.getElementsByTagName("td");
        var inputNome = document.getElementById("inputNome");
        var inputCPF = document.getElementById("inputCPF");
        var inputEmail = document.getElementById("inputEmail1");
        var inputTipoPessoa = document.getElementById("tipoPessoa");
        var textareaTexto = document.getElementById("textareaTexto");

        inputNome.value = celulas[0].innerHTML;
        inputCPF.value = celulas[1].innerHTML;
        inputEmail.value = celulas[2].innerHTML;
        inputTipoPessoa.value = celulas[3].innerHTML;
        textareaTexto.value = celulas[4].innerHTML;
    }

    // Variável para controlar o modo de operação (adicionar ou atualizar)
    var modoAdicionar = true;

    // Função para alternar entre os modos de adicionar e atualizar
    function alternarModo() {
        modoAdicionar = !modoAdicionar;
        var botaoAcao = document.getElementById("botaoAcao");
        if (modoAdicionar) {
            botaoAcao.textContent = "Adicionar Dados";
        } else {
            botaoAcao.textContent = "Atualizar Dados";
        }
    }

    // Função para limpar os campos de entrada
    function limparCampos() {
        document.getElementById("inputNome").value = "";
        document.getElementById("inputCPF").value = "";
        document.getElementById("inputEmail1").value = "";
        document.getElementById("tipoPessoa").value = "";
        document.getElementById("textareaTexto").value = "";
    }

    // Função para carregar os dados da linha de volta para os campos de entrada
    function carregarDadosParaEditar(linha) {
        var celulas = linha.getElementsByTagName("td");
        var inputNome = document.getElementById("inputNome");
        var inputCPF = document.getElementById("inputCPF");
        var inputEmail = document.getElementById("inputEmail1");
        var inputTipoPessoa = document.getElementById("tipoPessoa");
        var textareaTexto = document.getElementById("textareaTexto");

        inputNome.value = celulas[0].innerHTML;
        inputCPF.value = celulas[1].innerHTML;
        inputEmail.value = celulas[2].innerHTML;
        inputTipoPessoa.value = celulas[3].innerHTML;
        textareaTexto.value = celulas[4].innerHTML;

        // Salva a linha editável para referência posterior
        linhaEditavel = linha;

        // Muda para o modo de atualização
        alternarModo();
    }

    // Captura o botão "Cadastrar Evento"
    var botaoCadastrarEvento = document.getElementById('CadastrarEvento');

    // Adiciona um ouvinte de evento de clique ao botão
    botaoCadastrarEvento.addEventListener('click', function () {
        // Captura o valor do campo de entrada do nome do evento
        var nomeEvento = document.getElementById('nomeEvento').value;

        // Se o nome do evento estiver vazio, não faz nada
        if (nomeEvento.trim() === '') {
            alert('Por favor, insira o nome do evento.');
            return;
        }

        // Cria uma nova linha na tabela de eventos
        var tabelaEventos = document.querySelector('.tabela-eventos table');
        var novaLinha = tabelaEventos.insertRow(-1);
        var celulaEvento = novaLinha.insertCell(0);

        // Adiciona o nome do evento como texto dentro da célula da nova linha
        celulaEvento.textContent = nomeEvento;
    });

    //atualizado 10:40
</script>


